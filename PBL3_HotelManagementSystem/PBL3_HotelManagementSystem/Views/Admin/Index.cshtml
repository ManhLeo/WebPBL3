@model IEnumerable<PBL3_HotelManagementSystem.Models.IndexViewModel>

@{
    ViewBag.Title = "Admin";
    Layout = null;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="~/Assets/QUAN_LY.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body>
    <div class="Form" id="RoomForm">
        <form id="bookingForm" method="post" action="@Url.Action("BookRoom", "Admin")">
            <div class="Form_container">
                <div class="Form_item" style="justify-content: center;">
                    <p style="font-weight: 600;font-size: 24px;color: black;">ĐẶT PHÒNG</p>
                </div>
                <div class="Form_item">
                    <p>Họ và tên:</p>
                    <input type="text" class="input" name="FullName" required>
                </div>
                <div class="Form_item">
                    <p>Email:</p>
                    <input type="email" class="input" name="Email" required>
                </div>
                <div class="Form_item">
                    <p>CCCD:</p>
                    <input type="text" class="input" name="CCCD" required>
                </div>
                <div class="Form_item">
                    <p>SĐT:</p>
                    <input type="text" class="input" name="PhoneNumber" required>
                </div>
                <div class="Form_item">
                    <p>Địa chỉ:</p>
                    <input type="text" class="input" name="Address" required>
                </div>
                <div class="Form_item">
                    <p>Loại phòng:</p>
                    <select id="condition2" class="input input1" name="RoomType" required></select>
                </div>

                <div class="Form_item">
                    <p>Ngày nhận phòng:</p>
                    <input type="date" class="input" name="CheckInDate" required>
                </div>
                <div class="Form_item">
                    <p>Ngày trả phòng:</p>
                    <input type="date" class="input" name="CheckOutDate" required>
                </div>
                <div class="Form_item" style="justify-content: center;margin-top: 20px;">
                    <button type="submit" class="button1">ĐẶT PHÒNG</button>
                    <button type="button" class="button1" onclick="CloseForm('RoomForm')">Thoát</button>
                </div>
            </div>
        </form>
    </div>

    <div class="Form" id="BookServiceForm">
        <form id="ServiceForm" method="post" action="@Url.Action("BookService", "Admin")">
            <div class="Form_container">
                <div class="Form_item" style="justify-content: center;">
                    <p style="font-weight: 600;font-size: 24px;color: black;">ĐẶT DỊCH VỤ</p>
                </div>
                <div class="Form_item">
                    <p>Họ và tên:</p>
                    <input type="text" class="input" name="FullName" required>
                </div>
                <div class="Form_item">
                    <p>Email:</p>
                    <input type="email" class="input" name="Email" required>
                </div>
                <div class="Form_item">
                    <p>CCCD:</p>
                    <input type="text" class="input" name="CCCD" required>
                </div>
                <div class="Form_item">
                    <p>SĐT:</p>
                    <input type="text" class="input" name="PhoneNumber" required>
                </div>
                <div class="Form_item">
                    <p>Địa chỉ:</p>
                    <input type="text" class="input" name="Address" required>
                </div>
                <div class="Form_item">
                    <p>Dịch vụ:</p>
                    <div class="checkbox-list">
                        @foreach (var item in Model)
                        {
                            foreach (var service in item.Services)
                            {
                                <label>
                                    <input type="checkbox" name="SelectedServices" value="@service.IDDV" class="service-checkbox"> @service.TenDV
                                </label>
                                <div class="service-details">
                                    <input type="text" name="NumberofService" placeholder="SL" class="input50 service-input" disabled>
                                    <input type="date" name="NgaySuDung" class="input50 service-input" disabled>
                                </div>
                            }
                        }
                    </div>
                </div>
                <div class="Form_item" style="justify-content: center;margin-top: 20px;">
                    <button type="submit" class="button1">ĐẶT DịCH VỤ</button>
                    <button type="button" class="button1" onclick="CloseForm('BookServiceForm')">Thoát</button>
                </div>
            </div>
        </form>
    </div>


    <div class="Form" id="addServiceForm1">
        <form id="addServiceForm" method="post" action="@Url.Action("AddService", "Admin")">
            <div class="Form_container">
                <div class="Form_item" style="justify-content: center;">
                    <p style="font-weight: 600;font-size: 24px;color: black;">THÊM DỊCH VỤ</p>
                </div>
                <div class="Form_item">
                    <p>Tên dịch vụ:</p>
                    <input type="text" class="input" name="TenDV" required>
                </div>
                <div class="Form_item">
                    <p>Đơn giá:</p>
                    <input class="text" name="DonGia" required>
                </div>
                <div class="Form_item">
                    <p>Số lượng Max:</p>
                    <input class="text" name="SoLuongMax" required>
                </div>
                <div class="Form_item" style="justify-content: center; margin-top: 20px;">
                    <button type="submit" class="button1">THÊM</button>
                    <button type="button" class="button1" onclick="CloseForm('addServiceForm1')">Thoát</button>
                </div>
            </div>
        </form>
    </div>
    @*================================================================================================*@
    <div class="Form" id="EditRoomForm">
        <form id="editRoomForm">
            <div class="Form_container">
                <div class="Form_item" style="justify-content: center;">
                    <p style="font-weight: 600; font-size: 24px; color: black;">CHỈNH SỬA PHÒNG</p>
                </div>
                <input type="hidden" name="IDPHG" id="editRoomIDPHG">
                <div class="Form_item">
                    <p>Tên phòng:</p>
                    <input type="text" class="input" name="TenPHG" id="editRoomTenPHG" required>
                </div>
                <div class="Form_item">
                    <p>Loại phòng:</p>
                    <input id="editRoomLoaiPhong" class="input" name="TenLoaiPhong" required>
                </div>
                <div class="Form_item">
                    <p>Số giường:</p>
                    <input type="text" class="input" name="SoGiuong" id="editRoomSoGiuong" required>
                </div>
                <div class="Form_item" style="justify-content: center; margin-top: 20px;">
                    <button type="submit" class="button1" onclick="saveRoom()">LƯU</button>
                    <button type="button" class="button1" onclick="closeEditRoomForm()">Thoát</button>
                </div>
            </div>
        </form>
    </div>

    <div class="Form" id="EditCustomerForm">
        <form id="editCustomerForm">
            <div class="Form_container">
                <div class="Form_item" style="justify-content: center;">
                    <p style="font-weight: 600; font-size: 24px; color: black;">CHỈNH SỬA THÔNG TIN</p>
                </div>
                <input type="hidden" name="IDKH" id="editCustomerIDKH">
                <div class="Form_item">
                    <p>Họ Tên:</p>
                    <input type="text" class="input" name="HoTen" id="editCustomerHoTen" required>
                </div>
                <div class="Form_item">
                    <p>CCCD:</p>
                    <input id="editCustomerCCCD" class="input" name="CCCD" required>
                </div>
                <div class="Form_item">
                    <p>SDT:</p>
                    <input type="text" class="input" name="SDT" id="editCustomerSDT" required>
                </div>
                <div class="Form_item">
                    <p>Địa Chỉ:</p>
                    <input type="text" class="input" name="DiaChi" id="editCustomerDiaChi" required>
                </div>
                <div class="Form_item" style="justify-content: center; margin-top: 20px;">
                    <button type="submit" class="button1" onclick="saveCustomer()">LƯU</button>
                    <button type="button" class="button1" onclick="closeEditCustomerForm()">Thoát</button>
                </div>
            </div>
        </form>
    </div>

    <div class="Form" id="EditServiceForm">
        <form id="editServiceForm">
            <div class="Form_container">
                <div class="Form_item" style="justify-content: center;">
                    <p style="font-weight: 600; font-size: 24px; color: black;">CHỈNH SỬA DỊCH VỤ</p>
                </div>
                <input type="hidden" name="IDDV" id="editServiceIDDV">
                <div class="Form_item">
                    <p>Tên dịch vụ:</p>
                    <input type="text" class="input" name="TenDV" id="editServiceTenDV" required>
                </div>
                <div class="Form_item">
                    <p>Đơn giá:</p>
                    <input id="editServiceDonGia" class="input" name="DonGia" required>
                </div>
                <div class="Form_item">
                    <p>Số lượng max:</p>
                    <input type="text" class="input" name="SoLuongMax" id="editServiceSoLuongMax" required>
                </div>
                <div class="Form_item" style="justify-content: center; margin-top: 20px;">
                    <button type="submit" class="button1" onclick="saveService()">LƯU</button>
                    <button type="button" class="button1" onclick="closeEditServiceForm()">Thoát</button>
                </div>
            </div>
        </form>
    </div>


    <div class="Form" id="Update">
        <div class="Form_container" id="Update_container">
        </div>
    </div>

    <div class="container">
        <div class="taskbar">
            <div style="display: flex;align-items: center;">
                <img src="~/Assets/Logo_white.png" alt="" width="100">
                HMV HOTEL
            </div>
            <div class="Admin">
                <i class="fa-solid fa-user-tie"></i>
                ADMIN
            </div>
        </div>
        <div class="container_content">
            <div class="Title">
                <div class="Title_item" onclick="window.location.href='@Url.Action("Index", "Home")'">
                    <i class="fa-solid fa-house"></i>
                    Trang chủ
                </div>
                <div class="Title_item">
                    <i class="fa-solid fa-address-card"></i>
                    Giới thiệu
                </div>
                <div class="Title_item" onclick="MyForm('RoomForm')">
                    <i class="fa-solid fa-cart-flatbed"></i>
                    Đặt ngay
                </div>
                <div class="Title_item" id="manager">
                    <div>
                        <i class="fa-solid fa-list-check"></i>
                        Quản lý
                    </div>
                    <i class="fa-solid fa-arrow-down" id="Arrow"></i>
                </div>
                <div class="manager_item">
                    <div>
                        <input type="radio" name="type" onclick="roomManagement()" checked>
                        Tình trạng phòng
                    </div>
                    <div>
                        <input type="radio" name="type" onclick="actorManagement()">
                        Quản lý khách hàng
                    </div>
                    <div>
                        <input type="radio" name="type" onclick="serviceManagement()">
                        Quản lý dịch vụ
                    </div>
                    <div>
                        <input type="radio" name="type" onclick="billManagement()">
                        Quản lý hóa đơn
                    </div>
                </div>
            </div>
            <div class="manager_container" id="Room_management">
                <div class="manager_item1">
                    <div style="width: 100%;">
                        Quản lý phòng
                        <div class="line"></div>
                    </div>
                    <div class="room_choice_container">
                        <div class="choice">
                            Từ ngày:
                            <input type="date" id="fromDate" class="input1">
                        </div>
                        <div class="choice">
                            Đến ngày:
                            <input type="date" id="toDate" class="input1">
                        </div>
                        <div class="choice">
                            Loại phòng:
                            <select id="condition1" class="input input1"></select>
                        </div>
                        <div class="choice">
                            Trạng thái:
                            <select id="condition" class="input input1"></select>
                        </div>
                    </div>
                    <div style="width:100%;display: flex;justify-content: center;gap: 20px;">
                        <button class="button1" onclick="searchRooms()">Kiểm tra</button>
                        <button class="button1" onclick="MyForm('RoomForm')">Đặt phòng</button>
                    </div>
                </div>
                <div class="manager_item2">
                    <table>
                        <thead>
                            <tr>
                                <th>ID Phòng</th>
                                <th>Tên Phòng</th>
                                <th>Loại Phòng</th>
                                <th>Giá</th>
                                <th>Số giường</th>
                                <th>Trạng thái</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="roomTableBody">
                            @foreach (var item in Model)
                            {
                                foreach (var room in item.Rooms)
                                {
                                    <tr>
                                        <td>@room.IDPHG</td>
                                        <td>@room.TenPHG</td>
                                        <td>@room.LoaiPhong.TenLoaiPhong</td>
                                        <td>@room.LoaiPhong.DonGia</td>
                                        <td>@room.SoGiuong</td>
                                        <td>@room.TrangThai</td>
                                        <td>
                                            @if (room.TrangThai == "Bận")
                                            {
                                                <button onclick="createInvoice('@room.IDPHG')">Checkout</button>
                                            }
                                        </td>
                                        <td>
                                            <!-- Thêm cột cho nút thao tác -->
                                            <button onclick="openEditRoomForm('@room.IDPHG')">><i class="fas fa-pen-to-square"></i></button> <!-- Icon chỉnh sửa -->
                                            <button onclick="deleteRoom('@room.IDPHG')"><i class="fas fa-trash-alt"></i></button> <!-- Icon xóa -->
                                        </td>
                                    </tr>
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="manager_container" id="Actor_management">
                <div class="manager_item1">
                    <div style="width: 100%;">
                        Quản lý khách hàng
                        <div class="line"></div>
                    </div>
                    <div class="filter">
                        Tên khách hàng:
                        <input type="text" id="searchCustomerInput" placeholder="Nhập tên khách hàng">
                        <button onclick="searchCustomers()">Tìm kiếm</button>
                    </div>
                </div>
                <div class="manager_item2">
                    <table id="customerTable">
                        <thead>
                            <tr>
                                <th>IDKH</th>
                                <th>Họ và tên</th>
                                <th>CCCD</th>
                                <th>SĐT</th>
                                <th>Email</th>
                                <th>Địa chỉ</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody>

                            @foreach (var item in Model)
                            {
                                foreach (var customer in item.Customers)
                                {
                                    <tr>
                                        <td>@customer.IDKH</td>
                                        <td>@customer.HoTen</td>
                                        <td>@customer.CCCD</td>
                                        <td>@customer.SDT</td>
                                        <td>@customer.Email</td>
                                        <td>@customer.DiaChi</td>
                                        <td>
                                            <!-- Thêm cột cho nút thao tác -->
                                            <button onclick="openEditCustomerForm('@customer.IDKH')">><i class="fas fa-pen-to-square"></i></button> <!-- Icon chỉnh sửa -->
                                            <button onclick="deleteCustomer('@customer.IDKH')"><i class="fas fa-trash-alt"></i></button> <!-- Icon xóa -->
                                        </td>

                                    </tr>
                                }
                            }

                        </tbody>
                    </table>
                </div>
            </div>
            <div class="manager_container" id="Service_management">
                <div class="manager_item1">
                    <div style="width: 100%;">
                        Quản lý dịch vụ
                        <div class="line"></div>
                    </div>
                    <div class="filter">
                        Dịch vụ:
                        <input type="text" ID="searchServiceInput" placeholder="Thông tin dịch vụ">
                        <button onclick="searchServices()">Tìm kiếm</button>
                        <button class="button2" onclick="MyForm('addServiceForm1')">Thêm dịch vụ</button>
                        <button class="button2" onclick="MyForm('BookServiceForm')">Đặt dịch vụ</button>
                    </div>
                </div>
                <div class="manager_item2">
                    <table id="serviceTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Tên dịch vụ</th>
                                <th>Giá dịch vụ</th>
                                <th>Số lượng max</th>
                                <th>Số lượng đang dùng</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model)
                            {
                                foreach (var service in item.Services)
                                {
                                    <tr>
                                        <td>@service.IDDV</td>
                                        <td>@service.TenDV</td>
                                        <td>@service.DonGia</td>
                                        <td>@service.SoLuongMax</td>
                                        <td>@service.Soluong</td>
                                        <td>
                                            <!-- Thêm cột cho nút thao tác -->
                                            <button onclick="openEditServiceForm('@service.IDDV')">><i class="fas fa-pen-to-square"></i></button> <!-- Icon chỉnh sửa -->
                                            <button onclick="deleteService('@service.IDDV')"><i class="fas fa-trash-alt"></i></button> <!-- Icon xóa -->
                                        </td>

                                    </tr>
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="manager_container" id="Bill_management">
                <div class="manager_item1">
                    <div style="width: 100%;">
                        Quản lý hóa đơn
                        <div class="line"></div>
                    </div>
                    <div class="filter">
                        Tên khách hàng:
                        <input type="text" id="searchBillInput" placeholder="Nhập tên khách hàng">
                        <button onclick="searchBills()">Tìm kiếm</button>
                    </div>
                </div>
                <div class="manager_item2">
                    <table id="billTable">
                        <thead>
                            <tr>
                                <th>ID Hóa đơn</th>
                                <th>ID Khách Hàng</th>
                                <th>Họ tên</th>
                                <th>CCCD</th>
                                <th>Ngày nhận</th>
                                <th>Ngày trả</th>
                                <th>Thành tiền</th>
                                <th>Trạng thái</th>
                                <th>Thao tác</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model)
                            {
                                foreach (var bill in item.Bills)
                                {
                                    <tr>
                                        <td>@bill.IDHD</td>
                                        <td>@bill.IDKH</td>
                                        <td>@bill.KhachHang.HoTen</td>
                                        <td>@bill.KhachHang.CCCD</td>
                                        <td>@bill.DatPhongs.FirstOrDefault().NgayNhan.ToShortDateString()</td>
                                        <td>@bill.DatPhongs.FirstOrDefault().NgayTra.ToShortDateString()</td>
                                        <td>@bill.DonGia</td>
                                        <td style="color: red;"> @bill.TrangThai</td>
                                        <td>
                                            <button onclick="deleteBill('@bill.IDHD')"><i class="fas fa-trash-alt"></i></button> <!-- Icon xóa -->
                                        </td>
                                    </tr>
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script src="~/Assets/QUAN_LY.js"></script>
    <script src="~/Scripts/jquery-3.4.1.min.js"></script>
</body>
</html>